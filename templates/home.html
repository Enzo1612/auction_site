{% extends 'base.html' %}

{% block title %}Accueil - Site d'enchères au centime près{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="jumbotron bg-light p-5 rounded">
        <h1 class="display-4">Bienvenue sur Enchères Uniques</h1>
        <p class="lead">Participez à nos enchères au centime près et gagnez des produits à des prix incroyables!</p>
        <hr class="my-4">
        <p>Le principe est simple : proposez un prix unique (que personne d'autre n'a proposé) et le plus bas remporte l'enchère.</p>
        {% if not current_user.is_authenticated %}
        <a class="btn btn-primary btn-lg" href="{{ url_for('auth.register') }}" role="button">Inscrivez-vous</a>
        <a class="btn btn-outline-primary btn-lg" href="{{ url_for('auth.login') }}" role="button">Connectez-vous</a>
        {% else %}
        <a class="btn btn-primary btn-lg" href="{{ url_for('auction.list_auctions') }}" role="button">Voir les enchères</a>
        {% endif %}
    </div>

    <div class="row mt-5">
        <div class="col-md-6">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h3>Enchères en cours</h3>
                </div>
                <div class="card-body">
                    {% if active_auctions %}
                        <div class="list-group">
                            {% for auction in active_auctions %}
                                <a href="{{ url_for('auction.detail', auction_id=auction.id) }}" class="list-group-item list-group-item-action">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h5 class="mb-1">{{ auction.product.name }}</h5>
                                        <small>Termine dans {{ (auction.end_time - now).days }} jours</small>                                    </div>
                                    <p class="mb-1">{{ auction.product.description[:100] }}{% if auction.product.description|length > 100 %}...{% endif %}</p>
                                    <small>{{ auction.bids.count() }} enchères</small>                                </a>
                            {% endfor %}
                        </div>
                        <div class="mt-3">
                            <a href="{{ url_for('auction.list_auctions') }}" class="btn btn-outline-primary">Voir toutes les enchères</a>
                        </div>
                    {% else %}
                        <p class="text-center">Aucune enchère en cours actuellement.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-secondary text-white">
                    <h3>Enchères terminées</h3>
                </div>
                <div class="card-body">
                    {% if completed_auctions %}
                        <div class="list-group">
                            {% for item in completed_auctions %}
                                <a href="{{ url_for('auction.detail', auction_id=item.auction.id) }}" class="list-group-item list-group-item-action">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h5 class="mb-1">{{ item.auction.product.name }}</h5>
                                        <small>Terminé le {{ item.auction.end_time.strftime('%Y-%m-%d %H:%M:%S') }}</small>
                                    </div>
                                    <p class="mb-1">{{ item.auction.product.description[:100] }}{% if item.auction.product.description|length > 100 %}...{% endif %}</p>
                                    <small>
                                        {% if item.winner %}
                                            Gagnant : {{ item.winner.username }}
                                        {% else %}
                                            Aucun gagnant
                                        {% endif %}
                                    </small>
                                </a>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-center">Aucune enchère terminée pour le moment.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}